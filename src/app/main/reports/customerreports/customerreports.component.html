<div class="content-wrapper container-xxl p-0">
    <div class="content-body">

        <div class="row">
            <div class="col-12">

                <div class="card">
                    <div class="card-body">

                        <div class="row mb-2 float-right">
                            <a (click)="onviewall()" class="btn btn-danger btn-outline-primary float-right mr-1" rippleEffect>View All</a
                                >
                            <a (click)="generatePdf()" class="btn btn-outline-secondary float-right mr-1" rippleEffect>Download PDF</a
                                >
                         
                        </div>
                        <div class="form-group">
                            <label>
                            Choose Customer
                          </label>
                            <ng-select class="ng-select-size-lg" #SelectSizeLarge (change)="onCustomerSelect($event)" [items]="cust" [searchable]="true" bindLabel="cnic" bindValue="id" [(ngModel)]="this.selectedCustomer">
                                <ng-template ng-header-tmp>
                                    <input class="form-control w-100" placeholder="search customer by cnic" type="text" (input)="SelectSizeLarge.filter($event.target.value)" />
                                </ng-template>
                                <!--/ select size large -->
                            </ng-select>
                        </div>
                        <div class="form-group">
                            <label>
                            Choose Reports
                          </label>
                            <select class="form-control" (change)="onreportselect($event.target.value)">
                              <option *ngFor="let report of this.ApputilsService.CustomerReports">
                                {{report}}
                              </option>
                            </select>
                        </div>

                    </div>
                </div>
            </div>


        </div>

        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        Customer Apartments
                        <div class="float-right">

                        </div>
                    </div>
                    <div class="card-body">
                        <table class="table table-bordered">
                            <thead>
                                <th>
                                    Apartment Name
                                </th>
                                <th>
                                    Apartment Total Price
                                </th>
                                <th>
                                    Purchased On
                                </th>
                                <th>
                                    Status
                                </th>
                            </thead>
                            <tbody>
                                <tr *ngFor="let apt of this.customersales">
                                    <td>
                                        {{this.apt.apartmentname}}
                                    </td>
                                    <td>
                                        {{this.apt.apartmenttotalprice | number}}
                                    </td>
                                    <td>
                                        {{this.apt.createdat.seconds * 1000 | date}}
                                    </td>
                                    <td>
                                        {{this.apt.status}}
                                    </td>
                                    <td>
                                        <a class="mr-1" (click)="dismissdialog()" routerLink="/sales/{{this.apt.id}}" container="body" placement="top" ngbTooltip="Preview Invoice"><i size="18" data-feather="eye"></i
                                            ></a>
                            </td>
                            </tr>
                            </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" *ngIf="this.report == 0">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                Customer Aging Report
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="mb-2">
                                <label>
                        Choose Filter Option
                      </label>
                                <select class="form-control" (ngModel)="this.selectedagingfilter" (change)="agingfilter($event.target.value)">
                              <option *ngFor="let opt of this.ApputilsService.AgingFilters" value="{{this.opt}}">
                                {{this.opt}}
                              </option>
                            </select>
                            </div>
                            <div class="row">
                                <div class="col-12 mb-2">
                                    <!-- <a csvLink [data]="this.agingreport" class="btn btn-outline-secondary float-right mr-1" rippleEffect>Export CSV</a
                                    > -->

                                </div>
                            </div>
                            <div class="row">
                                <table *ngIf="viewall" id="table" class="pdftable table table-bordered">
                                    <thead>
                                        <tr>
                                            <td>
                                                Name
                                            </td>
                                            <td>
                                                0-30
                                            </td>
                                            <td>
                                                31-60
                                            </td>
                                            <td>
                                                60-90
                                            </td>
                                            <td>
                                                > 90
                                            </td>
                                            <td>
                                                Total
                                            </td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let in of this.allaging">
                                            <td>
                                                {{this.in.customername }}
                                            </td>
                                            <td>
                                                {{this.in.amount30 | number}}
                                            </td>
                                            <td>
                                                {{this.in.amount60 | number}}
                                            </td>
                                            <td>
                                                {{this.in.amount90 | number}}
                                            </td>
                                            <td>
                                                {{this.in.amount100 | number}}
                                            </td>
                                            <td>
                                                {{this.in.total | number}}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <table *ngIf="!viewall" id="table" class="pdftable table table-bordered">
                                    <thead>
                                        <tr>
                                            <td>
                                                TotalAmount
                                            </td>
                                            <td>
                                                Amount Paid
                                            </td>
                                            <td>
                                                Amount Left
                                            </td>
                                            <td>
                                                Type
                                            </td>
                                            <td>
                                                Date
                                            </td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let invoice of this.aginginvoices">
                                            <td>
                                                {{invoice.amount | number}}
                                            </td>
                                            <td>
                                                {{invoice.amountpaid | number}}
                                            </td>
                                            <td>
                                                {{invoice.amountleft | number}}
                                            </td>
                                            <td>
                                                {{invoice.type}}
                                            </td>
                                            <td>
                                                {{invoice?.invoicedueon?.seconds * 1000 | date}}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                        </div>

                    </div>
                </div>
            </div>

            <div class="row" *ngIf="this.report == 1">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                Over Due Invoices
                            </div>
                            <label (click)="filter()">
                            {{this.filtertext}}
                          </label>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-12 mb-2">
                                    <div class="mb-2">
                                        <a csvLink [data]="this.overduecustomerinvoices" class="btn btn-outline-secondary float-right mr-1" rippleEffect>Export CSV</a
                                        >
                                </div>
                            </div>
                        </div>
                       <div class="row">
                           <div class="col-12">
                            <table class="pdftable table table-bordered">
                                <thead>
                                    <tr>
                                        <td>
                                            Customer Name
                                        </td>
                                        <td>
                                            TotalAmount
                                        </td>
                                        <td>
                                            Amount Paid
                                        </td>
                                        <td>
                                            Amount Left
                                        </td>
                                        <td>
                                            Type
                                        </td>
                                        <td>
                                            Date
                                        </td>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let invoice of this.overduecustomerinvoices"  >
                                      
                                      <td>
                                          {{invoice.customer}}
                                      </td>
                                        <td>
                                            {{invoice.amount | number}}
                                        </td>
                                        <td>
                                            {{invoice.amountpaid | number}}
                                        </td>
                                        <td>
                                            {{invoice.amountleft | number}}
                                        </td>
                                        <td>
                                            {{invoice.type}}
                                        </td>
                                        <td>
                                            {{invoice?.invoicedueon?.seconds * 1000 | date}}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                           </div>
                       </div>
                     
                    </div>
                </div>
            </div>
        </div>

        <div class="row" *ngIf="this.report == 2">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            Customer Ledger Report
                        </div>
                        <label (click)="filter()">
                            {{this.filtertext}}
                          </label>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-12 mb-2">
                                <div class="mb-2">
                                    <a (click)="ledgercsv()" class="btn btn-outline-secondary float-right mr-1" rippleEffect>Export CSV</a
                                        >
                                </div>
                            </div>
                        </div>
                        

                        
                        <table class=" pdftable table table-bordered">
                            <thead>
                                <tr>
                                    <td>
                                        Name
                                    </td>
                                   
                                   
                                    <td>
                                        Date
                                    </td>
                                    <td>
                                        Bank
                                    </td>
                                    <td>
                                        Apartment Name
                                    </td>
                                    <td>
                                        Invoice Id
                                    </td>
                                    <td>
                                        Transaction Id
                                    </td>
                                    <td>
                                        Debit
                                    </td>
                                    <td>
                                        Credit
                                    </td>
                                    <td>
                                        Balance
                                    </td>
                                </tr>
                            </thead>
                            <tbody >
                                <tr *ngFor="let balance of this.ALLbalancedetail" [ngStyle]="{  'background-color':(balance.customername=='Total') ? 'rgb(2 165 22)':'#ffffffff' }"
                                
                                [style.font-size]="{'font-size':(balance.customername=='Total') ? '18px':'12px'}"
                                
                                >
                                    <td>
                                        {{balance.customername}}
                                    </td>
                                   
                                    
                                            <td>
                                                {{balance.transactiondate?.seconds * 1000 | date }}
                                            </td>
                                            <td>
                                                {{balance.bank }}
                                            </td>
                                            <td>
                                                {{balance.apartmentname }}
                                            </td>
                                            <td>
                                                {{balance.invoicename}}
                                            </td>
                                            <td>
                                                {{balance.transactionid }}
                                            </td>

                                            <td>
                                                {{balance.debit | number}}
                                            </td>
                                            <td>
                                                {{balance.credit | number}}
                                            </td>
                                            <td>
                                                {{balance.bankamount | number}}
                                            </td>
                                        

                                </tr>
                          
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </div>

        <div class="row" *ngIf="this.report == 3">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            UpComing Invoices
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="mb-2">
                            <label (click)="filter()">
                        Choose Filter Option
                      </label>

                        </div>
                        <div class="mb-2">
                            <a csvLink [data]="this.upcomingcustomerinvoices" class="btn btn-outline-secondary float-right mr-1" rippleEffect>Export CSV</a
                                >
                        </div>
                        <table class="pdftable table table-bordered">
                            <thead>
                                <tr>
                                    <td>
                                        Customer
                                    </td>
                                    <td>
                                        TotalAmount
                                    </td>
                                    <td>
                                        Amount Paid
                                    </td>
                                    <td>
                                        Amount Left
                                    </td>
                                    <td>
                                        Type
                                    </td>
                                    <td>
                                        Date
                                    </td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let invoice of this.upcomingcustomerinvoices">
                                   <td>
                                       {{invoice.customer}}
                                   </td>
                                    <td>
                                        {{invoice.amount | number}}
                                    </td>
                                    <td>
                                        {{invoice.amountpaid | number}}
                                    </td>
                                    <td>
                                        {{invoice.amountleft | number}}
                                    </td>
                                    <td>
                                        {{invoice.type}}
                                    </td>
                                    <td>
                                        {{invoice?.invoicedueon?.seconds * 1000 | date}}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>